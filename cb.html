<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <link rel="icon" type="image/x-icon" href="logo.png" />
        <title>Paste AI Response — Extract & Copy Code Blocks v2</title>
        <style>
            :root {
                --bg: #0f1724;
                --card: #0b1220;
                --muted: #94a3b8;
                --accent: #60a5fa;
                --glass: rgba(255, 255, 255, 0.03);
                font-family:
                    Inter,
                    ui-sans-serif,
                    system-ui,
                    -apple-system,
                    "Segoe UI",
                    Roboto,
                    "Helvetica Neue",
                    Arial;
            }

            * {
                box-sizing: border-box;
            }

            html,
            body {
                height: 100%;
                margin: 0;
                padding: 0;
                background: linear-gradient(180deg, #071024 0%, #0b1220 100%);
                color: #e6eef8;
                overflow-x: hidden;
            }

            .wrap {
                max-width: 1200px;
                margin: 0 auto;
                padding: clamp(12px, 3vw, 28px);
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: clamp(12px, 2vw, 24px);
                align-items: start;
                min-height: 100vh;
                width: 100%;
            }

            header {
                grid-column: 1/-1;
                display: flex;
                flex-wrap: wrap;
                gap: 12px;
                align-items: center;
                margin-bottom: clamp(8px, 2vw, 16px);
                width: 100%;
            }

            h1 {
                font-size: clamp(16px, 4vw, 20px);
                margin: 0;
                font-weight: 600;
                word-break: break-word;
            }

            p.lead {
                margin: 0;
                color: var(--muted);
                font-size: clamp(12px, 2.5vw, 14px);
                line-height: 1.4;
                max-width: 100%;
                word-wrap: break-word;
            }

            .header-buttons {
                margin-left: auto;
                display: flex;
                gap: 8px;
                align-items: center;
                flex-shrink: 0;
            }

            textarea {
                width: 100%;
                min-height: clamp(300px, 50vh, 520px);
                max-height: 70vh;
                resize: vertical;
                border-radius: 10px;
                border: 1px solid rgba(255, 255, 255, 0.04);
                padding: 12px;
                background: linear-gradient(
                    180deg,
                    rgba(255, 255, 255, 0.02),
                    transparent
                );
                color: inherit;
                font-family:
                    ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono",
                    monospace;
                font-size: clamp(12px, 2.5vw, 13px);
                box-shadow: 0 6px 18px rgba(2, 6, 23, 0.6);
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .left,
            .right {
                background: var(--card);
                padding: clamp(10px, 2vw, 16px);
                border-radius: 12px;
                box-shadow: 0 8px 30px rgba(2, 6, 23, 0.6);
                width: 100%;
                min-width: 0; /* Important for flex/grid children */
            }

            .controls {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-bottom: 8px;
                align-items: center;
                width: 100%;
            }

            button,
            .btn {
                background: linear-gradient(
                    180deg,
                    rgba(255, 255, 255, 0.02),
                    rgba(255, 255, 255, 0.01)
                );
                border: 1px solid rgba(255, 255, 255, 0.04);
                color: var(--accent);
                padding: clamp(6px, 1.5vw, 8px) clamp(8px, 2vw, 12px);
                border-radius: 8px;
                cursor: pointer;
                font-weight: 600;
                font-size: clamp(11px, 2.5vw, 13px);
                white-space: nowrap;
                min-width: 0;
                flex-shrink: 1;
                transition: all 0.2s ease-in-out;
            }

            button:hover,
            .btn:hover {
                background: rgba(255, 255, 255, 0.03);
                border-color: rgba(255, 255, 255, 0.08);
            }

            .btn.secondary {
                color: var(--muted);
                border-style: dashed;
                background: transparent;
            }

            .btn.secondary:hover {
                background: rgba(255, 255, 255, 0.01);
                border-color: rgba(255, 255, 255, 0.06);
                color: #bfe1ff; /* Slightly brighter on hover */
            }

            .preview-area {
                min-height: clamp(300px, 50vh, 520px);
                max-height: 70vh;
                overflow: auto;
                width: 100%;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .segment {
                margin-bottom: 12px;
                color: var(--muted);
                white-space: pre-wrap;
                line-height: 1.5;
                font-size: clamp(13px, 2.5vw, 14px);
                word-wrap: break-word;
                overflow-wrap: break-word;
                max-width: 100%;
            }

            pre.code-block {
                position: relative;
                margin: 0 0 12px 0;
                border-radius: 10px;
                padding: 12px;
                background: linear-gradient(
                    180deg,
                    rgba(255, 255, 255, 0.02),
                    rgba(255, 255, 255, 0.01)
                );
                overflow: auto;
                font-family:
                    ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono",
                    monospace;
                font-size: clamp(11px, 2vw, 13px);
                border: 1px solid rgba(255, 255, 255, 0.03);
                max-width: 100%;
                word-wrap: break-word;
                overflow-wrap: break-word;
                transition: all 0.2s ease-in-out;
                /* Default for maximized state */
                max-height: 500px; /* A reasonable max-height for non-minimized blocks */
            }

            pre.code-block:focus {
                outline: 2px solid var(--accent);
                outline-offset: 2px;
                background: rgba(255, 255, 255, 0.04);
            }

            pre.code-block code {
                white-space: pre-wrap;
                display: block;
                color: #e6eef8;
                word-wrap: break-word;
                overflow-wrap: break-word;
                max-width: 100%;
            }

            /* Minimized state for code blocks */
            pre.code-block.minimized {
                max-height: 50px; /* Adjust as needed */
                overflow: hidden;
                padding-bottom: 40px; /* Ensure space for the copy button */
            }

            /* Ensure content and language label are still somewhat visible when minimized, but content is hidden */
            pre.code-block.minimized > div {
                /* Language label */
                padding-bottom: 0;
            }

            pre.code-block.minimized code {
                height: 0; /* Hide the content */
                visibility: hidden; /* Ensure it doesn't take up space and is not selectable */
                padding: 0;
                margin: 0;
            }

            .copy-btn {
                position: absolute;
                right: 10px;
                top: 8px; /* Maintain position relative to the block */
                padding: clamp(4px, 1vw, 6px) clamp(6px, 1.5vw, 8px);
                border-radius: 8px;
                font-size: clamp(11px, 2vw, 12px);
                background: var(--accent); /* More visible background */
                color: #0f172a; /* Darker text for contrast */
                border: 1px solid rgba(255, 255, 255, 0.1);
                z-index: 2;
                font-weight: 700; /* Bolder text */
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3); /* Subtle shadow */
                transition:
                    background 0.2s ease,
                    transform 0.1s ease;
            }

            .copy-btn:hover {
                background: #468dfd; /* Slightly darker on hover */
                transform: translateY(-1px);
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            }

            .copy-btn:active {
                transform: translateY(0);
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
            }

            .meta {
                font-size: clamp(11px, 2vw, 12px);
                color: var(--muted);
                margin-bottom: 8px;
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .toast {
                position: fixed;
                right: clamp(12px, 3vw, 20px);
                bottom: clamp(12px, 3vw, 20px);
                background: #071936;
                color: #bfe1ff;
                padding: 10px 14px;
                border-radius: 10px;
                border: 1px solid rgba(96, 165, 250, 0.15);
                transform: translateY(8px);
                opacity: 0;
                pointer-events: none;
                transition: all 0.25s;
                z-index: 1000;
                max-width: calc(100vw - 24px);
                word-wrap: break-word;
                overflow-wrap: break-word;
            }

            .toast.show {
                opacity: 1;
                transform: translateY(0);
                pointer-events: auto;
            }

            footer {
                grid-column: 1/-1;
                font-size: clamp(12px, 2vw, 13px);
                color: var(--muted);
                margin-top: clamp(8px, 2vw, 16px);
                line-height: 1.4;
                word-wrap: break-word;
                overflow-wrap: break-word;
                width: 100%;
            }

            .button-group {
                display: flex;
                flex-wrap: wrap;
                gap: 8px;
                margin-top: 8px;
                width: 100%;
            }

            .button-group button {
                flex: 1;
                min-width: 120px;
            }

            .right-controls {
                display: flex;
                flex-wrap: wrap;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 8px;
                gap: 8px;
            }

            .right-controls .button-group {
                margin-top: 0;
                flex-grow: 1;
                justify-content: flex-end; /* Align to the right within the group */
            }

            /* Tablet and mobile styles */
            @media (max-width: 1024px) {
                .wrap {
                    grid-template-columns: 1fr;
                    gap: clamp(16px, 4vw, 24px);
                    padding: clamp(16px, 4vw, 24px);
                }

                header {
                    flex-direction: column;
                    align-items: flex-start;
                    gap: 16px;
                }

                .header-buttons {
                    margin-left: 0;
                    width: 100%;
                    justify-content: flex-start;
                }

                textarea,
                .preview-area {
                    min-height: clamp(250px, 40vh, 400px);
                    max-height: 60vh;
                }

                .button-group button {
                    min-width: 100px;
                }

                .right-controls {
                    flex-direction: column;
                    align-items: flex-start;
                }

                .right-controls .button-group {
                    justify-content: flex-start;
                    width: 100%;
                }
            }

            @media (max-width: 640px) {
                .wrap {
                    padding: clamp(12px, 3vw, 16px);
                    gap: 16px;
                }

                header {
                    gap: 12px;
                }

                .controls {
                    flex-direction: column;
                    align-items: flex-start;
                }

                .button-group {
                    flex-direction: column;
                }

                .button-group button {
                    width: 100%;
                    min-width: auto;
                }

                .header-buttons {
                    flex-direction: column;
                    width: 100%;
                }

                .header-buttons button {
                    width: 100%;
                }

                pre.code-block {
                    padding: 10px;
                    font-size: 12px;
                }

                .copy-btn {
                    position: relative; /* Make it stack or fit better on small screens */
                    right: auto;
                    top: auto;
                    margin-top: 8px;
                    width: 100%;
                }
                .right-controls {
                    flex-direction: column;
                    align-items: flex-start;
                }
                .right-controls .button-group {
                    flex-direction: column;
                    width: 100%;
                }
            }

            @media (max-width: 400px) {
                .wrap {
                    padding: 8px;
                }

                h1 {
                    font-size: 16px;
                }

                p.lead {
                    font-size: 12px;
                }

                pre.code-block {
                    padding: 8px;
                    font-size: 11px;
                }

                textarea,
                .preview-area {
                    min-height: 200px;
                }
            }

            /* Ensure scrollbars are styled nicely */
            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }

            ::-webkit-scrollbar-track {
                background: rgba(255, 255, 255, 0.02);
                border-radius: 4px;
            }

            ::-webkit-scrollbar-thumb {
                background: rgba(255, 255, 255, 0.1);
                border-radius: 4px;
            }

            ::-webkit-scrollbar-thumb:hover {
                background: rgba(255, 255, 255, 0.15);
            }
        </style>
    </head>
    <body>
        <div class="wrap" role="main">
            <header>
                <div>
                    <h1>Paste AI response → extract code blocks</h1>
                    <p class="lead">
                        Paste the AI response (markdown fenced code blocks using
                        <code>```</code>) and the page will show each code block
                        with its own Copy button.
                    </p>
                </div>
                <div class="header-buttons">
                    <button id="btnDetect" class="btn">Detect & Render</button>
                    <button id="btnClear" class="btn secondary">Clear</button>
                </div>
            </header>

            <div class="left">
                <div class="controls">
                    <span class="meta">Paste AI response here</span>
                </div>
                <textarea
                    id="input"
                    placeholder="Paste AI response (e.g. markdown with ```code fences)"
                ></textarea>
                <div class="button-group">
                    <button id="btnPaste" class="btn secondary">
                        Paste from Clipboard
                    </button>
                    <button id="btnAuto" class="btn">
                        Auto-detect on paste
                    </button>
                </div>
            </div>

            <div class="right" aria-live="polite">
                <div class="right-controls">
                    <span class="meta"
                        >Rendered preview — code blocks get a Copy button</span
                    >
                    <div class="button-group">
                        <button id="btnMinimizeAll" class="btn secondary">
                            Minimize All
                        </button>
                        <button id="btnPrevCode" class="btn secondary">
                            Previous Code
                        </button>
                        <button id="btnNextCode" class="btn secondary">
                            Next Code
                        </button>
                    </div>
                </div>
                <div id="preview" class="preview-area" tabindex="0">
                    <div class="segment">
                        No content yet. Paste an AI response on the left and
                        click
                        <strong>Detect & Render</strong>.
                    </div>
                </div>
            </div>

            <footer>
                Tip: fenced code blocks must use triple backticks, e.g.
                <code>```js</code> or <code>```</code>. This page preserves code
                exactly (no surrounding backticks) so copying pastes only the
                code content.
            </footer>
        </div>

        <div id="toast" class="toast" role="status" aria-live="polite">
            Copied!
        </div>

        <script>
            (function () {
                const input = document.getElementById("input");
                const preview = document.getElementById("preview");
                const btnDetect = document.getElementById("btnDetect");
                const btnClear = document.getElementById("btnClear");
                const btnPaste = document.getElementById("btnPaste");
                const btnAuto = document.getElementById("btnAuto");
                const btnPrevCode = document.getElementById("btnPrevCode");
                const btnNextCode = document.getElementById("btnNextCode");
                const btnMinimizeAll =
                    document.getElementById("btnMinimizeAll"); // New button
                const toast = document.getElementById("toast");
                let autoOnPaste = false;
                let currentCodeBlockIndex = -1;
                let allCodeBlocksMinimized = false; // New state variable

                // Escape HTML for non-code text segments to avoid XSS
                function escapeHtml(str) {
                    return str
                        .replace(/&/g, "&amp;")
                        .replace(/</g, "&lt;")
                        .replace(/>/g, "&gt;")
                        .replace(/"/g, "&quot;")
                        .replace(/'/g, "&#39;");
                }

                // Convert plaintext paragraphs to simple HTML with paragraphs and line breaks
                function formatPlainText(text) {
                    // trim leading/trailing newlines
                    let t = text.replace(/^\n+|\n+$/g, "");
                    // split on two or more newlines -> paragraphs
                    const paras = t.split(/\n{2,}/).map((p) => p.trim());
                    return paras
                        .map(
                            (p) =>
                                '<div class="segment">' +
                                escapeHtml(p).replace(/\n/g, "<br>") + // Replaced '\n' with '<br>' for visible line breaks in text segments
                                "</div>",
                        )
                        .join("");
                }

                // Parse input text into alternating non-code and code segments
                // Code fence regex: ```optional-lang\n...```
                function renderFromText(text) {
                    if (!text || text.trim().length === 0) {
                        preview.innerHTML =
                            '<div class="segment">No content yet. Paste an AI response on the left and click <strong>Detect & Render</strong>.</div>';
                        currentCodeBlockIndex = -1; // Reset index
                        updateCodeNavigationButtons(); // Update button states
                        updateMinimizeAllButtonState(); // Update minimize button state
                        return;
                    }
                    // The regex needs to handle CRLF and LF consistently.
                    // `(?:\r?\n)?` handles optional newline after language, then `[\s\S]*?` for content.
                    const regex = /```(?:([\w.+-]+)\r?\n)?([\s\S]*?)```/g;
                    let lastIndex = 0;
                    let m;
                    const nodes = [];
                    while ((m = regex.exec(text)) !== null) {
                        // text before this code block
                        if (m.index > lastIndex) {
                            const before = text.slice(lastIndex, m.index);
                            if (before.trim() !== "")
                                nodes.push({ type: "text", content: before });
                        }
                        // code block
                        const lang = m[1] || "";
                        const code = m[2] || "";
                        nodes.push({ type: "code", lang, content: code });
                        lastIndex = regex.lastIndex;
                    }
                    // any remaining text after last match
                    if (lastIndex < text.length) {
                        const tail = text.slice(lastIndex);
                        if (tail.trim() !== "")
                            nodes.push({ type: "text", content: tail });
                    }

                    // Build DOM
                    preview.innerHTML = "";
                    nodes.forEach((seg, idx) => {
                        if (seg.type === "text") {
                            const wrapper = document.createElement("div");
                            // convert paragraphs: keep safe
                            wrapper.innerHTML = formatPlainText(seg.content);
                            preview.appendChild(wrapper);
                        } else if (seg.type === "code") {
                            const pre = document.createElement("pre");
                            pre.className = "code-block";
                            pre.tabIndex = -1; // Make it focusable programmatically
                            // add language label if present
                            if (seg.lang) {
                                const label = document.createElement("div");
                                label.style.fontSize = "12px";
                                label.style.color = "var(--muted)";
                                label.style.marginBottom = "6px";
                                label.textContent = seg.lang;
                                pre.appendChild(label);
                            }
                            const codeEl = document.createElement("code");
                            // preserve code exactly (no trimming)
                            codeEl.textContent = seg.content;
                            pre.appendChild(codeEl);

                            const copyBtn = document.createElement("button");
                            copyBtn.className = "copy-btn";
                            copyBtn.type = "button";
                            copyBtn.textContent = "Copy";
                            copyBtn.setAttribute(
                                "aria-label",
                                "Copy code to clipboard",
                            );
                            copyBtn.addEventListener("click", async (e) => {
                                e.stopPropagation(); // Prevent focusing the pre tag when clicking copy button
                                try {
                                    await navigator.clipboard.writeText(
                                        seg.content,
                                    );
                                    showToast("Code copied to clipboard");
                                    // brief visual feedback
                                    copyBtn.textContent = "Copied!";
                                    setTimeout(
                                        () => (copyBtn.textContent = "Copy"),
                                        1200,
                                    );
                                } catch (err) {
                                    showToast("Clipboard write failed");
                                    console.error(err);
                                }
                            });
                            pre.appendChild(copyBtn);
                            preview.appendChild(pre);
                        }
                    });

                    // If no code blocks found, show a helpful message plus rendered text
                    const anyCode = nodes.some((s) => s.type === "code");
                    if (!anyCode) {
                        const info = document.createElement("div");
                        info.className = "meta";
                        info.style.marginTop = "6px";
                        info.textContent =
                            "No fenced code blocks (``` ... ```) detected.";
                        preview.appendChild(info);
                        currentCodeBlockIndex = -1; // No code blocks, reset index
                    } else {
                        currentCodeBlockIndex = 0; // Initialize to the first code block
                    }
                    updateCodeNavigationButtons(); // Update button states
                    updateMinimizeAllButtonState(); // Update minimize button state
                }

                function showToast(msg) {
                    toast.textContent = msg;
                    toast.classList.add("show");
                    setTimeout(() => toast.classList.remove("show"), 1800);
                }

                // Navigation for code blocks
                function navigateCodeBlocks(direction) {
                    const codeBlocks =
                        preview.querySelectorAll("pre.code-block");
                    if (codeBlocks.length === 0) return;

                    if (direction === "next") {
                        currentCodeBlockIndex =
                            (currentCodeBlockIndex + 1) % codeBlocks.length;
                    } else if (direction === "prev") {
                        currentCodeBlockIndex =
                            (currentCodeBlockIndex - 1 + codeBlocks.length) %
                            codeBlocks.length;
                    }

                    const targetBlock = codeBlocks[currentCodeBlockIndex];
                    if (targetBlock) {
                        // Remove focus from previously focused block
                        codeBlocks.forEach((block) => {
                            if (block !== targetBlock) {
                                block.blur();
                            }
                        });

                        targetBlock.focus(); // Focus the current block
                        targetBlock.scrollIntoView({
                            behavior: "smooth",
                            block: "nearest",
                        });
                    }
                }

                function updateCodeNavigationButtons() {
                    const codeBlocks =
                        preview.querySelectorAll("pre.code-block");
                    btnPrevCode.disabled = codeBlocks.length === 0;
                    btnNextCode.disabled = codeBlocks.length === 0;
                }

                function updateMinimizeAllButtonState() {
                    const codeBlocks =
                        preview.querySelectorAll("pre.code-block");
                    btnMinimizeAll.disabled = codeBlocks.length === 0;
                    if (codeBlocks.length === 0) {
                        btnMinimizeAll.textContent = "Minimize All";
                        allCodeBlocksMinimized = false;
                    } else if (allCodeBlocksMinimized) {
                        btnMinimizeAll.textContent = "Maximize All";
                    } else {
                        btnMinimizeAll.textContent = "Minimize All";
                    }
                }

                // New function to toggle minimize/maximize all code blocks
                function toggleMinimizeAllCodeBlocks() {
                    const codeBlocks =
                        preview.querySelectorAll("pre.code-block");
                    if (codeBlocks.length === 0) return;

                    allCodeBlocksMinimized = !allCodeBlocksMinimized;

                    codeBlocks.forEach((block) => {
                        if (allCodeBlocksMinimized) {
                            block.classList.add("minimized");
                        } else {
                            block.classList.remove("minimized");
                        }
                    });
                    updateMinimizeAllButtonState();
                }

                // Bind buttons
                btnDetect.addEventListener("click", () =>
                    renderFromText(input.value),
                );
                btnClear.addEventListener("click", () => {
                    input.value = "";
                    preview.innerHTML =
                        '<div class="segment">Cleared. Paste new content.</div>';
                    currentCodeBlockIndex = -1; // Reset index
                    allCodeBlocksMinimized = false; // Reset minimize state
                    updateCodeNavigationButtons();
                    updateMinimizeAllButtonState();
                });
                btnPaste.addEventListener("click", async () => {
                    try {
                        const txt = await navigator.clipboard.readText();
                        input.value = txt;
                        renderFromText(txt);
                        showToast("Pasted from clipboard");
                    } catch (err) {
                        showToast("Cannot read clipboard");
                        console.error(err);
                    }
                });

                btnAuto.addEventListener("click", () => {
                    autoOnPaste = !autoOnPaste;
                    btnAuto.textContent = autoOnPaste
                        ? "Auto-detect on paste: ON"
                        : "Auto-detect on paste";
                    btnAuto.classList.toggle("secondary", !autoOnPaste);
                    showToast(
                        autoOnPaste
                            ? "Auto-detect enabled"
                            : "Auto-detect disabled",
                    );
                });

                btnPrevCode.addEventListener("click", () =>
                    navigateCodeBlocks("prev"),
                );
                btnNextCode.addEventListener("click", () =>
                    navigateCodeBlocks("next"),
                );
                btnMinimizeAll.addEventListener(
                    "click",
                    toggleMinimizeAllCodeBlocks,
                ); // New event listener

                // auto-detect when user pastes into textarea
                input.addEventListener("paste", (ev) => {
                    if (autoOnPaste) {
                        // Use requestAnimationFrame to ensure the browser has processed the paste
                        // and the textarea's value is updated before we read it.
                        requestAnimationFrame(() => {
                            renderFromText(input.value);
                        });
                    }
                });

                // also allow Ctrl+Enter to render
                input.addEventListener("keydown", (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
                        e.preventDefault();
                        renderFromText(input.value);
                    }
                });

                // initial sample
                input.value =
                    'Example AI response with two code blocks:\n\nHere is some introductory text before the first code block, explaining its purpose. It can span multiple lines.\n\n```js\nfunction greet(name){\n  return `Hello, ${name}!`\n}\n\n// This is a JS function\nconst add = (a, b) => a + b;\n\n// A few more lines to show scrolling\nconsole.log(greet("World"));\nconsole.log(add(5, 3));\nconst multiply = (x, y) => x * y;\nconsole.log(multiply(4, 2));\nconst divide = (a, b) => a / b;\nconsole.log(divide(10, 2));\n```\n\nSome descriptive text between the code blocks, maybe discussing the next snippet.\n\nAnd here is HTML:\n\n```html\n<div class="card">\n  <h1>Welcome</h1>\n  <p>This is an example HTML structure.</p>\n  <ul>\n    <li>Item 1</li>\n    <li>Item 2</li>\n  </ul>\n  <button>Click Me</button>\n</div>\n```\n\nPlain text after all code blocks, wrapping up the response or giving further instructions.';
                // render sample on load
                renderFromText(input.value);
                updateCodeNavigationButtons(); // Ensure buttons are correctly enabled/disabled on load
                updateMinimizeAllButtonState(); // Ensure minimize button is correctly enabled/disabled on load
            })();
        </script>
    </body>
</html>
